% mini theme

% packages
\usepackage[none]{hyphenat}
\usepackage{etex}
\usepackage[utf8]{inputenc}
%%\usepackage[spanish]{babel} %% Uncomment for spanish slides
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage{hyperref} % links
\usepackage{pstricks,pst-grad}
\usepackage[percent]{overpic}
\usepackage[absolute,overlay]{textpos}

\usepackage{tikz}
\usetikzlibrary{calc,arrows,shapes,shadows,positioning}

\input{minicommon.tex}

\renewcommand{\arraystretch}{1.5}
\setbeamersize{text margin left=0.2cm}
\setbeamersize{text margin right=0.2cm}

% define colours
\definecolor{MiniBlack}{HTML}{353131}
\definecolor{MiniWhite}{HTML}{FFFFFF}
\definecolor{MiniLightBlue}{RGB}{214,237,252}  % #d6edfc
\definecolor{MiniBlue}{RGB}{0,110,191}         % #006ebf
\definecolor{MiniLightGreen}{RGB}{213,247,244} % #0d5f7f4
\definecolor{MiniGreen}{RGB}{0,134,127}        % #00867f
\definecolor{MiniLightGrey}{RGB}{245,243,238}  % #f5f3ee
\definecolor{MiniGrey}{HTML}{636565}
\definecolor{MiniDarkGrey}{RGB}{51,51,51}      % #333333
\definecolor{MiniLightRed}{RGB}{254,222,237}   % #c40064
\definecolor{MiniRed}{RGB}{196,0,100}          % #fedeed

%% fonts
\renewcommand\mathfamilydefault{\rmdefault}
\renewcommand\familydefault{\rmdefault}
\setbeamerfont{title}{family*={fouriernc}, size=\fontsize{30}{32}}
\setbeamerfont{author}{family*={fouriernc}, size=\large}
\setbeamerfont*{block title}{size*={10}{0}, family*={fouriernc}, series=\bfseries}
\setbeamerfont{block body}{size*={8}{0}, family*={fouriernc}}
\setbeamerfont{itemize/enumerate body}{size=\normalsize}
\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}
\setbeamerfont{itemize/enumerate subsubbody}{size=\small}

%% set colours
\setbeamercolor{enumerate item}{fg=MiniBlue}
\setbeamercolor{alerted text}{fg=MiniBlue}
\setbeamercolor{section in toc}{fg=MiniBlack}

\setbeamercolor{block title}{bg=MiniLightBlue,fg=MiniBlack}
\setbeamercolor{block body}{bg=MiniLightBlue,fg=MiniBlack}

%$ make the itemize bullets pixelated >
\setbeamertemplate{itemize item}{
  \tikz{
    \draw[draw=none] (0, 0.00) rectangle (0, 0.02);
    \draw[draw=none,fill=MiniBlue] (0, 0.11) circle (0.04);
    }
}

%% make the subitems also pixelated >, but a little smaller and gray
\setbeamertemplate{itemize subitem}{
    \tikz{
      \draw[draw=none] (0, 0.00) rectangle (0, 0.02);
      \draw[draw=none,fill=MiniGrey] (0, 0.11) circle (0.04);
    }
}

\setlength\labelsep   {\dimexpr\labelsep - 0.4em\relax}
\setlength\leftmargini{\dimexpr\leftmargini - 0.4em\relax}

\setbeamertemplate{block begin}{%
  \vspace*{1ex}
  \begin{beamercolorbox}[%
    ht=2.4ex,
    dp=1ex,
    leftskip=1ex,
    rightskip=2ex]{block title}
    \usebeamerfont{block title}\insertblocktitle
  \end{beamercolorbox}%
  \vspace*{-2pt}
  \begin{beamercolorbox}[%
    dp=1ex,
    leftskip=1ex,
    rightskip=1ex,
    vmode]{block body}%
    \usebeamerfont{block body}%
}
\setbeamertemplate{block end}{%
  \end{beamercolorbox}
 \vspace*{0.2ex}
}

\addtobeamertemplate{block begin}{%
  \setbeamercolor{itemize item}{fg=MiniBlack}
  \setbeamertemplate{itemize item}{-}
}{}


% disable navigation
\setbeamertemplate{navigation symbols}{}

% custom draw the title page above
\setbeamertemplate{title page}{}

% again, manually draw the frame title above
\setbeamertemplate{frametitle}{}

% disable "Figure:" in the captions
\setbeamertemplate{caption}{\tiny\insertcaption}
\setbeamertemplate{caption label separator}{}

% use \makeatletter for our progress bar definitions
\makeatletter
\newcount\progressbar@tmpcounta % auxiliary counter
\newcount\progressbar@tmpcountb % auxiliary counter
\newdimen\progressbar@pbwidth % progressbar width
\newdimen\progressbar@tmpdim % auxiliary dimension

\newdimen\slidewidth % auxiliary dimension
\newdimen\slideheight % auxiliary dimension

% make the progress bar go across the screen
\progressbar@pbwidth=\the\paperwidth
\slidewidth=\the\paperwidth
\slideheight=\the\paperheight

\setbeamertemplate{footline}{
  \progressbar@tmpcounta=\insertframenumber
  \progressbar@tmpcountb=\inserttotalframenumber
  \progressbar@tmpdim=\progressbar@pbwidth
  \multiply\progressbar@tmpdim by \progressbar@tmpcounta
  \divide\progressbar@tmpdim by \progressbar@tmpcountb

  \begin{tikzpicture}

    \draw[fill=MiniWhite,draw=none] (0cm,0cm) rectangle (\slidewidth,0.05cm);
    \draw[fill=MiniWhite,draw=none] (0cm,0cm) rectangle (\progressbar@tmpdim,0.05cm);

    \node[anchor=south east,color=MiniDarkGrey,font=\tiny,scale=0.8] at (\slidewidth,0.08cm) {\insertframenumber/\inserttotalframenumber};%

  \end{tikzpicture}
}
\makeatother

\setbeamertemplate{headline}{}
\setbeamertemplate{frametitle}{
  \begin{tikzpicture}
    % title bar
    \fill[color=MiniWhite] (0cm, \slideheight-1cm) rectangle (\slidewidth,\slideheight);
    \node[anchor=north west,text width=\slidewidth-1cm,font=\Large\bf,inner ysep=0.25cm,color=mini-black] at (0,\slideheight) {\insertframetitle};
  \end{tikzpicture}
}


\makeatletter
\setbeamertemplate{title page}{%
  \hspace*{-\beamer@leftmargin}%
  \begin{tikzpicture}
    % set up the entire slide as the canvas
    \useasboundingbox (0,0) rectangle (\slidewidth,\slideheight);

    % the background
    \fill[color=MiniWhite] (0,0) rectangle(\the\paperwidth,\the\paperheight);

    % draw the actual text
    \node[anchor=south west,text width=\slidewidth-1cm,inner sep=0, outer sep=0, font=\fontsize{22}{20}\selectfont\bf, color=mini-black] at (0.5cm,5cm) {\baselineskip=1.25cm\inserttitle\par};

    \ifx\author\@empty\else
    \node[anchor=south west,align=left,color=MiniBlack,font=\normalsize] at (0.5cm,3cm) {\insertauthor};
    \fi
    \ifx\insertinstitute\@empty\else
    \node[anchor=south west,align=left,color=MiniBlack] at (0.5cm,2.5cm) {\insertinstitute};
    \fi
    \ifx\insertshortdate\@empty\else
    \node[anchor=south west,align=left,color=MiniBlack] at (0.5cm,1.0cm) {\insertshortdate};
    \fi
    \ifx\insertdate\@empty\else
    \node[anchor=south west,align=left,color=MiniBlack] at (0.5cm,0.5cm) {\insertdate};
    \fi
    \ifx\inserttitlegraphic\@empty\else
    \node[anchor=south east] at(\slidewidth-0.5cm,0.5cm) {\inserttitlegraphic};
    \fi
  \end{tikzpicture}%
}
\makeatother
